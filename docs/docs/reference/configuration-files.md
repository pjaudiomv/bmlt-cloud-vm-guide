# Configuration Templates

Ready-to-use configuration templates for BMLT server management.

## Apache Virtual Host Template

### Basic HTTP Virtual Host

Template for initial Apache configuration (HTTPS is automatically generated by Certbot):

```apache title="/etc/apache2/sites-available/your-domain.com.conf"
<VirtualHost *:80>
    ServerAdmin webmaster@your-domain.com
    ServerName your-domain.com
    DocumentRoot /var/www/your-domain.com
    
    ErrorLog ${APACHE_LOG_DIR}/your-domain.com_error.log
    CustomLog ${APACHE_LOG_DIR}/your-domain.com_access.log combined
    
    # Redirect all HTTP to HTTPS (after SSL setup)
    RewriteEngine on
    RewriteCond %{SERVER_NAME} =your-domain.com
    RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
    
    <Directory "/var/www/your-domain.com">
        AllowOverride All
        Require all granted
    </Directory>
</VirtualHost>
```

:::info SSL Configuration
The HTTPS virtual host is automatically created by Certbot when you run `sudo certbot --apache -d your-domain.com`. You don't need to create it manually.
:::

## Database Backup Script

### Simple Local Backup Script

Basic database backup script for local storage:

```bash title="/usr/local/bin/backup-bmlt.sh"
#!/bin/bash
# BMLT Database Backup Script

# Configuration
BACKUP_DIR="/var/backups/bmlt"
DATE=$(date +'%Y-%m-%d')
RETENTION_DAYS=30

# Create backup directory
mkdir -p ${BACKUP_DIR}

# Create backups
mysqldump bmlt | gzip > ${BACKUP_DIR}/bmlt-${DATE}.sql.gz
mysqldump yap | gzip > ${BACKUP_DIR}/yap-${DATE}.sql.gz

# Set secure permissions
chmod 600 ${BACKUP_DIR}/*.gz
chown root:root ${BACKUP_DIR}/*.gz

# Remove old backups
find ${BACKUP_DIR} -name "*.sql.gz" -mtime +${RETENTION_DAYS} -delete

echo "Backup completed: bmlt-${DATE}.sql.gz, yap-${DATE}.sql.gz"
```

Make it executable and schedule:
```bash
# Make executable
sudo chmod +x /usr/local/bin/backup-bmlt.sh

# Add to crontab for daily backup at 2 AM
sudo crontab -e
# Add line: 0 2 * * * /usr/local/bin/backup-bmlt.sh
```

## Template Variables

When using these templates, replace these variables with your actual values:

- `your-domain.com` → Your domain name
- `admin@your-domain.com` → Your email address
- `/var/www/your-domain.com` → Your web directory path

## Usage Examples

### Test the backup script:
```bash
sudo /usr/local/bin/backup-bmlt.sh
ls -la /var/backups/bmlt/
```

:::tip
Always test scripts in a non-production environment first. Use `bash -x script.sh` to debug if needed.
:::

:::warning
These templates are based on actual infrastructure deployments. Customize the paths and settings for your specific environment.
:::